#!/usr/bin/env ruby
require_relative 'lib/environment'
require_relative 'lib/parse_arguments'

command = ARGV[0]
category = ARGV[1]
options = ParseArguments.parse
options[:name] = ARGV[2]

Environment.environment = options[:environment] || "production"
database = Environment.database_connection

error_messages = ParseArguments.validate(options,category)
if error_messages.empty?
  movie = Movie.new(options)
  success = movie.save
  if success
    puts "A #{category} titled #{movie.name} with genre #{movie.genre}, year #{movie.year}, length #{movie.length}, budget #{movie.budget}, and mpaa #{movie.mpaa} was created."
  else
    puts "A #{category} titled #{options[:name]} has already been created."
  end
else
  puts error_messages
end